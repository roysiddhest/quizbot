<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUIZBOT - Ultimate Quiz Game</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            position: relative;
            overflow-x: hidden;
        }
        
        .background-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.03;
            background-image: 
                radial-gradient(circle at 25% 25%, #00d4ff 2px, transparent 2px),
                radial-gradient(circle at 75% 75%, #ff6b9d 2px, transparent 2px);
            background-size: 100px 100px;
            z-index: -1;
        }
        
        .container {
            max-width: 900px;
            width: 95%;
            padding: 20px;
            text-align: center;
            position: relative;
        }
        
        .game-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }
        
        .control-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid #323232;
            background: linear-gradient(135deg, #2d2d44, #3a3a5c);
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .control-btn:hover {
            background: linear-gradient(135deg, #3a3a5c, #4a4a7c);
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0, 212, 255, 0.4);
        }
        
        .screen {
            background: linear-gradient(145deg, #1e1e2e, #252545);
            border: 2px solid #00d4ff;
            border-radius: 25px;
            padding: 40px;
            box-shadow: 
                0 0 50px rgba(0, 212, 255, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                0 20px 40px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        /* Make start screen 20% narrower */
        #startScreen {
            max-width: 80%;
            margin: 0 auto;
        }
        
        .screen::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(0, 212, 255, 0.03), transparent);
            animation: shimmer 3s linear infinite;
            pointer-events: none;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        
        .hidden { display: none; }
        
        .logo {
            font-size: 4.5em;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #00d4ff, #ff6b9d, #c44569);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(0, 212, 255, 0.5);
            animation: logoGlow 2s ease-in-out infinite alternate;
            font-weight: bold;
            letter-spacing: 3px;
        }
        
        @keyframes logoGlow {
            from { filter: drop-shadow(0 0 20px rgba(0, 212, 255, 0.5)); }
            to { filter: drop-shadow(0 0 40px rgba(255, 107, 157, 0.7)); }
        }
        
        .subtitle {
            font-size: 1.6em;
            margin: 30px 0;
            color: #00d4ff;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }
        
        .game-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }
        
        .info-card {
            background: linear-gradient(135deg, #ff6b9d, #c44569);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 20px rgba(255, 107, 157, 0.3);
            transform: perspective(1000px) rotateX(5deg);
            transition: all 0.3s ease;
        }
        
        .info-card:hover {
            transform: perspective(1000px) rotateX(0deg) translateY(-10px);
            box-shadow: 0 20px 40px rgba(255, 107, 157, 0.4);
        }
        
        .info-card h3 {
            font-size: 1.8em;
            margin-bottom: 10px;
        }
        
        .btn {
            background: linear-gradient(135deg, #00d4ff, #0099cc);
            border: none;
            padding: 18px 40px;
            border-radius: 50px;
            color: white;
            font-size: 1.4em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 
                0 10px 20px rgba(0, 212, 255, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            margin: 20px 10px;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.3s;
        }
        
        .btn:hover::before {
            left: 100%;
        }

        
        .option-btn {
            display: block;
            width: 100%;
            margin: 15px 0;
            padding: 20px 25px;
            background: linear-gradient(135deg, #2d2d44, #3a3a5c);
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 15px;
            color: white;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            position: relative;
            overflow: hidden;
        }
        

.option-btn:hover::before {
    left: -100%; /* Keep static instead of 100% */
}


        .option-btn.correct {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            border-color: #27ae60;
            animation: correctPulse 0.7s ease;
        }
        
        .option-btn.correct::after {
            content: '‚úì';
            position: absolute;
            right: 25px;
            top: 50%;
            transform: translateY(-30%);
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            animation: checkmark 0.5s ease 0.3s both;
        }
        
        .option-btn.incorrect {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            border-color: #e74c3c;
            animation: shake 0.7s ease;
        }
        
        .option-btn.incorrect::after {
            content: '‚úó';
            position: absolute;
            right: 25px;
            top: 50%;
            transform: translateY(-30%);
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            animation: crossmark 0.5s ease 0.3s both;
        }
        
        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }
        
        @keyframes checkmark {
            0% { transform: translateY(-50%) scale(0); opacity: 0; }
            100% { transform: translateY(-50%) scale(1); opacity: 1; }
        }
        
        @keyframes crossmark {
            0% { transform: translateY(-50%) scale(0) rotate(0deg); opacity: 0; }
            100% { transform: translateY(-50%) scale(1) rotate(180deg); opacity: 1; }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-15px); }
            75% { transform: translateX(15px); }
        }
        
        .timer {
            font-size: 2.2em;
            font-weight: bold;
            padding: 20px;
            background: linear-gradient(135deg, #ff6b9d, #c44569);
            border-radius: 50%;
            width: 90px;
            height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            border: 3px solid rgba(255, 107, 157, 0.5);
            box-shadow: 0 0 30px rgba(255, 107, 157, 0.4);
        }
        
        .timer.warning {
            animation: timerWarning 0.8s infinite;
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            border-color: #e74c3c;
            box-shadow: 0 0 30px rgba(231, 76, 60, 0.6);
        }
        
        @keyframes timerWarning {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .progress {
            width: 100%;
            height: 12px;
            background: linear-gradient(135deg, #2d2d44, #3a3a5c);
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
            border: 1px solid rgba(0, 212, 255, 0.3);
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(135deg, #00d4ff, #ff6b9d);
            transition: width 0.5s ease;
            border-radius: 6px;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }
        
        .score-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            gap: 20px;
        }
        
        .score-card {
            background: linear-gradient(135deg, #2d2d44, #3a3a5c);
            padding: 15px 25px;
            border-radius: 15px;
            border: 2px solid rgba(0, 212, 255, 0.3);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            flex: 1;
        }
        
        .score-card h3 {
            font-size: 1.1em;
            color: #00d4ff;
            margin-bottom: 5px;
        }
        
        .score-card .value {
            font-size: 1.5em;
            font-weight: bold;
            color: white;
        }
        
        .question-category {
            display: inline-block;
            background: linear-gradient(135deg, #ff6b9d, #c44569);
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1em;
            font-weight: bold;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(255, 107, 157, 0.3);
        }
        
        .results-container {
            text-align: center;
        }
        
        .results-icon {
            font-size: 5em;
            margin: 20px 0;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-20px); }
            60% { transform: translateY(-10px); }
        }
        
        .final-score {
            font-size: 3.5em;
            font-weight: bold;
            margin: 30px 0;
            background: linear-gradient(135deg, #00d4ff, #ff6b9d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .percentage {
            font-size: 2.5em;
            margin: 20px 0;
            font-weight: bold;
        }
        
        .victory-animation {
            animation: victory 2s ease-in-out;
        }
        
        @keyframes victory {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.05) rotate(2deg); }
            50% { transform: scale(1.1) rotate(-2deg); }
            75% { transform: scale(1.05) rotate(1deg); }
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            animation: fall 4s linear infinite;
        }
        
        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }
        
        .question-text {
            font-size: 1.5em;
            line-height: 1.7;
            margin: 30px 0;
            color: #f8f9fa;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        /* Separate containers for info (left) and controls (right) */
.info-controls {
    position: fixed;
    top: 20px;
    left: 20px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    z-index: 1000;
}

.game-controls {
    position: fixed;
    top: 20px;
    right: 20px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    z-index: 1000;
}

/* Info label appears to the right of the i button */
.info-label {
    position: absolute;
    left: 60px;
    top: 0;
    background: rgba(0, 0, 0, 0.8);
    padding: 8px 12px;
    border-radius: 15px;
    font-size: 0.85em;
    white-space: nowrap;
    color: white;
    border: 1px solid rgba(0, 212, 255, 0.3);
    visibility: hidden;
    opacity: 0;
    transition: all 0.3s ease;
    z-index: 1001;
}


        /* Enhanced Mobile Optimization */
@media (max-width: 768px) {
    body {
        padding: 5px;
    }
        .info-controls {
        top: 18px;
        left: 18px;
    }
    .game-controls {
        top: 10px;
        right: 10px;
    }
    .container {
        max-width: 100%;
        width: 98%;
        padding: 5px;
        min-height: 98%;
    }
    
    /* Start Screen Mobile Optimization */
    #startScreen {
        max-width: 98%;
        padding: 12px 8px;
        height:95%;
    }
    
    .logo { 
        font-size: 2.5em; 
        margin-bottom: 15px;
        letter-spacing: 1px;
    }
    
    .subtitle { 
        font-size: 1.1em; 
        margin: 15px 0;
    }
    
    .game-info {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
        margin: 20px 0;
    }
    
    .info-card { 
        transform: none;
        padding: 15px 10px;
        border-radius: 10px;
    }
    
    .info-card h3 {
        font-size: 1.4em;
        margin-bottom: 5px;
    }
    
    .info-card p {
        font-size: 0.9em;
    }
    
    .btn {
        font-size: 1.1em;
        padding: 12px 25px;
        margin: 15px 5px;
    }
    
    /* Game Screen Mobile Optimization */
    .screen {
        padding: 15px 10px;
        border-radius: 15px;
    }
    
    .game-controls {
        top: 15px;
        right: 10px;
        gap: 10px !important;
    }
    
    .control-btn {
        width: 40px;
        height: 40px;
        font-size: 1.2em;
    }
    
    .progress {
        height: 8px;
        margin: 15px 0;
    }
    
    .score-section { 
        flex-direction: row;
        gap: 8px;
        margin-bottom: 20px;
        justify-content: space-between;
        align-items: center;
    }
    
    .score-card {
        padding: 8px 12px;
        flex: 0 1 auto;
        min-width: 60px;
        border-radius: 10px;
    }
    
    .score-card h3 {
        font-size: 0.9em;
        margin-bottom: 3px;
    }
    
    .score-card .value {
        font-size: 1.1em;
    }
    
    .timer {
        font-size: 1.6em;
        width: 65px;
        height: 65px;
        padding: 10px;
        flex: 0 0 65px;
    }
    
    .question-category {
        font-size: 0.9em;
        padding: 8px 15px;
        margin-bottom: 15px;
        border-radius: 15px;
    }
    
    .question-text {
        font-size: 1.2em;
        line-height: 1.5;
        margin: 20px 0;
    }
    
    .option-btn {
        margin: 10px 0;
        padding: 15px 18px;
        font-size: 1em;
        border-radius: 12px;
    }
    
    /* Results Screen Mobile Optimization */
    .results-icon {
        font-size: 3.5em;
        margin: 15px 0;
    }
    
    .final-score { 
        font-size: 2em;
        margin: 20px 0;
    }
    
    .percentage { 
        font-size: 1.6em;
        margin: 15px 0;
    }
    
    .results-container h1 {
        font-size: 2.2em !important;
        margin-bottom: 15px !important;
    }
    
    .results-container p {
        font-size: 1.1em !important;
        margin: 20px 0 !important;
    }
    
    .results-container div[style*="background: linear-gradient"] {
        padding: 15px !important;
        margin: 15px 0 !important;
        border-radius: 12px !important;
    }
    
    .results-container div[style*="background: linear-gradient"] h3 {
        font-size: 1em !important;
        margin-bottom: 8px !important;
    }
    
    .results-container div[style*="background: linear-gradient"] p {
        font-size: 0.9em !important;
        margin: 0 !important;
    }
    
    /* Screenshot button mobile optimization */
    .results-container div[style*="display: flex"] .final-score {
        font-size: 1.8em;
    }
    
    .results-container div[style*="display: flex"] button {
        width: 40px !important;
        height: 40px !important;
        font-size: 1.2em !important;
    }
    
    /* Action buttons mobile optimization */
    .results-container div[style*="margin-top: 40px"] {
        margin-top: 25px !important;
        flex-direction: column !important;
        gap: 10px !important;
    }
    
    .results-container .btn {
        width: 100%;
        max-width: 200px;
        margin: 5px auto !important;
        font-size: 1em;
        padding: 12px 20px;
    }
}

    </style>
</head>
<body>
    <div class="background-pattern"></div>
    
    <div class="container">
        <!-- Start Screen -->
       <!-- Start Screen -->
<div id="startScreen" class="screen">
    <!-- Add same game controls position for music button -->
    <div class="game-controls">
        <button class="control-btn" id="startMusicBtn" onclick="toggleMusic()" title="Toggle Music">üîä</button>
    </div>
    
    <div class="logo">ü§ñ QUIZBOT</div>
    <div class="subtitle">Ultimate Quiz Challenge</div>
    
    <div class="game-info">
        <div class="info-card">
            <h3>üéØ 25</h3>
            <p>Questions</p>
        </div>
        <div class="info-card">
            <h3>‚è±Ô∏è 30s</h3>
            <p>Per Question</p>
        </div>
        <div class="info-card">
            <h3>üèÜ 80%</h3>
            <p>To Win</p>
        </div>
        <div class="info-card">
            <h3>üí∞ 10</h3>
            <p>Points Each</p>
        </div>
    </div>
    
    <p style="font-size: 1.2em; margin: 30px 0; opacity: 0.9; color: #00d4ff;">
    Pop Culture, Science, Geopolitics, History, Sports, Astronomy and more!
    </p>
    
    <button class="btn" onclick="startGame()">üöÄ START CHALLENGE</button>
</div>

        
        <!-- Game Screen -->
        <div id="gameScreen" class="screen hidden">
            <div class="game-controls">
                <button class="control-btn" id="musicBtn" onclick="toggleMusic()" title="Toggle Music">üîä</button>
                <button class="control-btn" onclick="exitGame()" title="Exit Game">‚úï</button>
            </div>
            
            <div class="progress">
                <div id="progressBar" class="progress-bar" style="width: 0%"></div>
            </div>
            
            <div class="score-section">
                <div class="score-card">
                    <h3>Question</h3>
                    <div class="value"><span id="questionNum">1</span>/25</div>
                </div>
                <div class="timer" id="timer">30</div>
                <div class="score-card">
                    <h3>Score</h3>
                    <div class="value" id="score">0</div>
                </div>
            </div>
            
            <div class="question-category" id="category"></div>
            <div class="question-text" id="question"></div>
            <div id="options"></div>
        </div>
        
        <!-- Results Screen -->
        <div id="resultsScreen" class="screen hidden">
            <div id="resultsContent"></div>
        </div>
    </div>

    <script>
        // Game state
        let currentQuestion = 0;
        let score = 0;
        let timer = 30;
        let timerInterval;
        let questions = [];
        let selectedQuestions = [];
        let bgMusic = null;
        let musicInterval = null;
        let isMusicPlaying = true;
        let audioContext = null;
        let gainNode = null;
        
        // Single cool upbeat casino track with drums
        const casinoTrack = {
            melody: [
                // Main melody line - upbeat and catchy
                523.25, 659.25, 783.99, 1046.5, 783.99, 659.25, 783.99, 1046.5,
                587.33, 739.99, 880.00, 1174.7, 880.00, 739.99, 880.00, 1174.7,
                493.88, 622.25, 739.99, 987.77, 739.99, 622.25, 739.99, 987.77,
                659.25, 830.61, 987.77, 1318.5, 987.77, 830.61, 987.77, 1318.5
            ],
            rhythm: [0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.5, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.5, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.5, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.5],
            bassLine: [
                261.63, 261.63, 329.63, 329.63, 293.66, 293.66, 246.94, 246.94,
                220.00, 220.00, 277.18, 277.18, 246.94, 246.94, 195.99, 195.99
            ],
            bassRhythm: [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5],
            drums: {
                kick: [80, 80, 80, 80], // Kick drum frequencies
                snare: [200, 200, 200, 200], // Snare frequencies
                hihat: [8000, 8000, 8000, 8000] // Hi-hat frequencies
            },
            drumPattern: [1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0] // Beat pattern
        };
        
        // Create upbeat casino background music with drums
        function createBackgroundMusic() {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            let isPlaying = false;
            
            // Create master gain node for volume control
            gainNode = audioContext.createGain();
            gainNode.connect(audioContext.destination);
            gainNode.gain.setValueAtTime(isMusicPlaying ? 0.08 : 0, audioContext.currentTime);
            
            function playTone(frequency, duration, startTime, volume = 0.06, type = 'sawtooth') {
                const oscillator = audioContext.createOscillator();
                const toneGain = audioContext.createGain();
                
                oscillator.connect(toneGain);
                toneGain.connect(gainNode);
                
                oscillator.frequency.setValueAtTime(frequency, startTime);
                oscillator.type = type;
                
                toneGain.gain.setValueAtTime(0, startTime);
                toneGain.gain.linearRampToValueAtTime(volume, startTime + 0.01);
                toneGain.gain.setValueAtTime(volume, startTime + duration - 0.01);
                toneGain.gain.linearRampToValueAtTime(0, startTime + duration);
                
                oscillator.start(startTime);
                oscillator.stop(startTime + duration);
            }
            
            function playDrum(frequency, duration, startTime, volume = 0.03) {
                const oscillator = audioContext.createOscillator();
                const toneGain = audioContext.createGain();
                const filter = audioContext.createBiquadFilter();
                
                oscillator.connect(filter);
                filter.connect(toneGain);
                toneGain.connect(gainNode);
                
                oscillator.frequency.setValueAtTime(frequency, startTime);
                oscillator.type = 'square';
                filter.type = 'lowpass';
                filter.frequency.setValueAtTime(frequency * 2, startTime);
                
                toneGain.gain.setValueAtTime(volume, startTime);
                toneGain.gain.exponentialRampToValueAtTime(0.001, startTime + duration);
                
                oscillator.start(startTime);
                oscillator.stop(startTime + duration);
            }
            
            function createCasinoLoop() {
                if (!isPlaying) return;
                
                const now = audioContext.currentTime;
                let totalTime = 0;
                
                // Play main melody
                casinoTrack.melody.forEach((freq, i) => {
                    const duration = casinoTrack.rhythm[i];
                    playTone(freq, duration, now + totalTime, 0.05, 'sawtooth');
                    totalTime += duration;
                });
                
                // Play bass line
                let bassTime = 0;
                casinoTrack.bassLine.forEach((freq, i) => {
                    const duration = casinoTrack.bassRhythm[i];
                    playTone(freq, duration, now + bassTime, 0.04, 'triangle');
                    bassTime += duration;
                });
                
                // Play drum pattern
                casinoTrack.drumPattern.forEach((beat, i) => {
                    const beatTime = now + i * 0.25;
                    if (beat === 1) {
                        // Kick drum
                        playDrum(60, 0.15, beatTime, 0.06);
                        // Snare drum (every other beat)
                        if (i % 4 === 2) {
                            playDrum(200, 0.1, beatTime, 0.04);
                        }
                        // Hi-hat
                        playDrum(8000, 0.05, beatTime, 0.02);
                    }
                });
                
                // Add chord progression
                const chords = [
                    [523.25, 659.25, 783.99], // C major
                    [587.33, 739.99, 880.00], // D major
                    [493.88, 622.25, 739.99], // B major
                    [659.25, 830.61, 987.77]  // E major
                ];
                
                chords.forEach((chord, i) => {
                    chord.forEach((freq, j) => {
                        playTone(freq, 1.0, now + i * 2 + j * 0.02, 0.02, 'sine');
                    });
                });
            }
            
            return {
                start: function() {
                    if (audioContext.state === 'suspended') {
                        audioContext.resume();
                    }
                    isPlaying = true;
                    createCasinoLoop();
                    musicInterval = setInterval(createCasinoLoop, 8000);
                },
                stop: function() {
                    isPlaying = false;
                    if (musicInterval) {
                        clearInterval(musicInterval);
                        musicInterval = null;
                    }
                }
            };
        }
        
        function startBackgroundMusic() {
            try {
                if (!bgMusic) {
                    bgMusic = createBackgroundMusic();
                }
                bgMusic.start();
                updateMusicButton();
            } catch (e) {
                console.log('Audio not available');
            }
        }
        
        function stopBackgroundMusic() {
            if (bgMusic) {
                try {
                    bgMusic.stop();
                } catch (e) {
                    console.log('Error stopping audio');
                }
            }
        }
        
        function toggleMusic() {
            if (gainNode && audioContext) {
                isMusicPlaying = !isMusicPlaying;
                gainNode.gain.linearRampToValueAtTime(
                    isMusicPlaying ? 0.08 : 0, 
                    audioContext.currentTime + 0.1
                );
                updateMusicButton();
            }
        }
        
        function updateMusicButton() {
            const musicBtn = document.getElementById('musicBtn');
            const startMusicBtn = document.getElementById('startMusicBtn');
            
            if (musicBtn) {
                musicBtn.textContent = isMusicPlaying ? 'üîä' : 'üîá';
            }
            if (startMusicBtn) {
                startMusicBtn.textContent = isMusicPlaying ? 'üîä' : 'üîá';
            }
        }
        
        // Corrected Info button setup function
function setupInfoButton() {
    // Create separate info controls for each screen
    const screens = ['startScreen', 'gameScreen', 'resultsScreen'];
    
    screens.forEach(screenId => {
        const screen = document.getElementById(screenId);
        if (!screen) return;
        
        // Create info controls container (top-left)
        const infoControls = document.createElement('div');
        infoControls.className = 'info-controls';
        
        // Create info container
        const infoContainer = document.createElement('div');
        infoContainer.style.cssText = `
            position: relative;
            width: 50px;
            height: 50px;
        `;
        
        // Create info label
        const infoLabel = document.createElement('div');
        infoLabel.textContent = 'App Developed by Siddhest Roy';
        infoLabel.className = 'info-label';
        
        // Create info button
        const infoButton = document.createElement('button');
        infoButton.textContent = 'i';
        infoButton.title = 'App Info';
        infoButton.className = 'control-btn';
        
        infoContainer.appendChild(infoLabel);
        infoContainer.appendChild(infoButton);
        infoControls.appendChild(infoContainer);
        
        // Add to screen
        screen.appendChild(infoControls);
        
        // Toggle functionality
        let isInfoVisible = false;
        
        infoButton.addEventListener('click', (e) => {
            e.stopPropagation();
            isInfoVisible = !isInfoVisible;
            
            if (isInfoVisible) {
                infoLabel.style.visibility = 'visible';
                infoLabel.style.opacity = '1';
                setTimeout(() => {
                    document.addEventListener('click', handleOutsideClick);
                }, 10);
            } else {
                hideInfo();
            }
        });
        
        function hideInfo() {
            isInfoVisible = false;
            infoLabel.style.visibility = 'hidden';
            infoLabel.style.opacity = '0';
            document.removeEventListener('click', handleOutsideClick);
        }
        
        function handleOutsideClick(e) {
            if (!infoContainer.contains(e.target)) {
                hideInfo();
            }
        }
    });
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', setupInfoButton);


        function takeScreenshot() {
            // Create a temporary canvas to capture the results screen
            const resultsScreen = document.getElementById('resultsScreen');
            
            // Use html2canvas library if available, otherwise show message
            if (typeof html2canvas !== 'undefined') {
                html2canvas(resultsScreen).then(canvas => {
                    // Create download link
                    const link = document.createElement('a');
                    link.download = 'quizbot-score.png';
                    link.href = canvas.toDataURL();
                    link.click();
                });
            } else {
                // Fallback: Show instructions for manual screenshot
                alert('üì∏ To save your score:\n\n1. Right-click on the screen\n2. Select "Save as image" or take a screenshot\n3. Or use your device\'s screenshot feature');
            }
        }
        
        function exitGame() {
            // Create custom in-game popup without screen darkening
            const popup = document.createElement('div');
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                z-index: 10000;
                animation: popupSlide 0.3s ease-out;
            `;
            
            const dialog = document.createElement('div');
            dialog.style.cssText = `
                background: linear-gradient(145deg, #1e1e2e, #252545);
                border: 2px solid #00d4ff;
                border-radius: 25px;
                padding: 40px;
                text-align: center;
                color: white;
                box-shadow: 0 0 50px rgba(0, 212, 255, 0.3);
                max-width: 400px;
            `;
            
            dialog.innerHTML = `
                <h2 style="color: #00d4ff; margin-bottom: 20px;">Exit Game?</h2>
                <div style="display: flex; gap: 20px; justify-content: center;">
                    <button id="confirmExit" style="
                        background: linear-gradient(135deg, #e74c3c, #c0392b);
                        border: none;
                        padding: 18px 35px;
                        border-radius: 25px;
                        color: white;
                        font-size: 1.2em;
                        font-weight: bold;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    ">Exit</button>
                    <button id="cancelExit" style="
                        background: linear-gradient(135deg, #00d4ff, #0099cc);
                        border: none;
                        padding: 18px 35px;
                        border-radius: 25px;
                        color: white;
                        font-size: 1.2em;
                        font-weight: bold;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    ">Cancel</button>
                </div>
            `;
            
            // Add animation keyframe
            const style = document.createElement('style');
            style.textContent = `
                @keyframes popupSlide {
                    from { transform: translate(-50%, -50%) scale(0.7); opacity: 0; }
                    to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            popup.appendChild(dialog);
            document.body.appendChild(popup);
            
            // Handle button clicks
            document.getElementById('confirmExit').onclick = () => {
                document.body.removeChild(popup);
                document.head.removeChild(style);
                clearInterval(timerInterval); // Add this line
                stopBackgroundMusic(); // Add this line
                document.getElementById('gameScreen').classList.add('hidden');
                document.getElementById('resultsScreen').classList.add('hidden');
                document.getElementById('startScreen').classList.remove('hidden');
            };
            
            document.getElementById('cancelExit').onclick = () => {
                document.body.removeChild(popup);
                document.head.removeChild(style);
            };
        }
        
        // Rest of the code remains exactly the same...
        const questionBank = [
            // All your existing questions remain unchanged
            // Pop Culture & Entertainment (10 questions)
            {category: "üé¨ Pop Culture", q: "Which movie features the line 'I'll be back'?", options: ["Predator", "The Terminator", "Total Recall", "Conan"], correct: 1},
            {category: "üé¨ Pop Culture", q: "In which year was YouTube founded?", options: ["2004", "2005", "2006", "2007"], correct: 1},
            {category: "üé¨ Pop Culture", q: "Which Netflix series features Eleven?", options: ["Dark", "Stranger Things", "The Umbrella Academy", "Black Mirror"], correct: 1},
            {category: "üé¨ Pop Culture", q: "What is Batman's real name?", options: ["Bruce Wayne", "Clark Kent", "Peter Parker", "Tony Stark"], correct: 0},
            {category: "üé¨ Pop Culture", q: "Which Harry Potter actor played Snape?", options: ["Gary Oldman", "Ralph Fiennes", "Alan Rickman", "David Thewlis"], correct: 2},
            {category: "üé¨ Pop Culture", q: "What is the highest-grossing film of all time?", options: ["Titanic", "Avatar", "Avengers: Endgame", "Star Wars: The Force Awakens"], correct: 2},
            {category: "üé¨ Pop Culture", q: "Which streaming service produced 'The Crown'?", options: ["Netflix", "Amazon Prime", "Disney+", "HBO Max"], correct: 0},
            {category: "üé¨ Pop Culture", q: "What does 'MCU' stand for in movies?", options: ["Marvel Comic Universe", "Marvel Cinematic Universe", "Modern Cinema Universe", "Marvel Character Universe"], correct: 1},

            // World History & Culture (15 questions)
{category: "üìú World History", q: "In which year was the Magna Carta signed?", options: ["1066", "1215", "1492", "1689"], correct: 1},
{category: "üìú World History", q: "Which country was divided by the Berlin Wall?", options: ["France", "Germany", "Austria", "Poland"], correct: 1},
{category: "üìú World History", q: "In which country did the Chernobyl nuclear disaster occur?", options: ["Russia", "Ukraine", "Belarus", "Lithuania"], correct: 1},
{category: "üìú World History", q: "What does 'Carpe Diem' mean in Latin?", options: ["Seize the day", "Have no fear", "Time flies", "Peace be with you"], correct: 0},
{category: "üìú World History", q: "Which ancient wonder was located in Alexandria?", options: ["Colossus of Rhodes", "Lighthouse of Alexandria", "Temple of Artemis", "Mausoleum"], correct: 1},
{category: "üìú World History", q: "In which century was the Mona Lisa painted?", options: ["15th century", "16th century", "17th century", "14th century"], correct: 1},
{category: "üìú World History", q: "Who invented the telegraph?", options: ["Alexander Graham Bell", "Guglielmo Marconi", "Thomas Edison", "Samuel Morse"], correct: 3},
{category: "üìú World History", q: "Which empire built Machu Picchu?", options: ["Aztec", "Maya", "Inca", "Olmec"], correct: 2},
{category: "üìú World History", q: "In which year did the Great Fire of London occur?", options: ["1666", "1665", "1667", "1668"], correct: 0},
{category: "üìú World History", q: "Who was the first person to circumnavigate the globe?", options: ["Christopher Columbus", "Vasco da Gama", "Ferdinand Magellan", "James Cook"], correct: 2},
{category: "üìú World History", q: "Which country formerly ruled Iceland?", options: ["Norway", "Denmark", "Sweden", "United Kingdom"], correct: 1},
{category: "üìú World History", q: "The Silk Road connected which two regions?", options: ["Europe and Africa", "Asia and Europe", "America and Asia", "Africa and Asia"], correct: 1},
{category: "üìú World History", q: "Which civilization built Angkor Wat?", options: ["Thai", "Vietnamese", "Khmer", "Burmese"], correct: 2},
{category: "üìú World History", q: "In which country was Wolfgang Amadeus Mozart born?", options: ["Germany", "Austria", "Czech Republic", "Italy"], correct: 1},
{category: "üìú World History", q: "Which dynasty built the Forbidden City in Beijing?", options: ["Tang", "Song", "Ming", "Qing"], correct: 2},

// Science & Nature Around the World (10 questions)
{category: "üî¨ Global Science", q: "What chemical element is used to freeze food?", options: ["Sodium", "Hydrogen", "Oxygen", "Nitrogen"], correct: 3},
{category: "üî¨ Global Science", q: "Which animal is a symbol of courage in Chinese culture?", options: ["Lion", "Dragon", "Eagle", "Tiger"], correct: 1},
{category: "üî¨ Global Science", q: "What is considered the 'lung of the Earth'?", options: ["Amazon rainforest", "Sahara Desert", "Siberian Taiga", "Congo Basin"], correct: 0},
{category: "üî¨ Global Science", q: "What is the phobia of thunder and rain called?", options: ["Agoraphobia", "Ombrophobia", "Acrophobia", "Claustrophobia"], correct: 1},
{category: "üî¨ Global Science", q: "Which country is home to the Great Victoria Desert?", options: ["United States", "Australia", "South Africa", "Chile"], correct: 1},
{category: "üî¨ Global Science", q: "What type of leaf is on the Canadian flag?", options: ["Oak", "Maple", "Pine", "Birch"], correct: 1},
{category: "üî¨ Global Science", q: "Which U.S. state has the most active volcanoes?", options: ["Hawaii", "Alaska", "California", "Washington"], correct: 1},
{category: "üî¨ Global Science", q: "What season does Australia experience in December?", options: ["Spring", "Summer", "Autumn", "Winter"], correct: 1},
{category: "üî¨ Global Science", q: "In which hemisphere do most humans live?", options: ["Northern", "Southern", "Eastern", "Western"], correct: 0},
{category: "üî¨ Global Science", q: "Which country is known for having the best quality tap water?", options: ["Norway", "Switzerland", "Denmark", "Finland"], correct: 1},

// World Cuisine & Culture (10 questions)
{category: "üçΩÔ∏è World Cuisine", q: "Peking Duck is the national dish of which country?", options: ["Japan", "China", "Korea", "Thailand"], correct: 1},
{category: "üçΩÔ∏è World Cuisine", q: "Where does sushi originate from?", options: ["Japan", "China", "Korea", "Thailand"], correct: 0},
{category: "üçΩÔ∏è World Cuisine", q: "Which country invented the croissant?", options: ["France", "Austria", "Germany", "Italy"], correct: 1},
{category: "üçΩÔ∏è World Cuisine", q: "What is the main ingredient in hummus?", options: ["Lentils", "Chickpeas", "Black beans", "Kidney beans"], correct: 1},
{category: "üçΩÔ∏è World Cuisine", q: "What spice gives curry its yellow color?", options: ["Saffron", "Turmeric", "Paprika", "Cumin"], correct: 1},
{category: "üçΩÔ∏è World Cuisine", q: "Which country is the origin of the tango dance?", options: ["Spain", "Brazil", "Argentina", "Mexico"], correct: 2},
{category: "üçΩÔ∏è World Cuisine", q: "What is the traditional bread of India called?", options: ["Pita", "Naan", "Tortilla", "Baguette"], correct: 1},
{category: "üçΩÔ∏è World Cuisine", q: "Which country is famous for kimchi?", options: ["Japan", "China", "Korea", "Vietnam"], correct: 2},
{category: "üçΩÔ∏è World Cuisine", q: "What is the currency of Japan?", options: ["Won", "Yuan", "Yen", "Dollars"], correct: 2},

// 15 Difficult Science Questions
{category: "üî¨ Hard Science", q: "What is the theoretical boundary around a black hole beyond which nothing can escape?", options: ["Event Horizon", "Schwarzschild Radius", "Photon Sphere", "Ergosphere"], correct: 0},
{category: "üî¨ Hard Science", q: "What is the powerhouse organelle of the cell called?", options: ["Nucleus", "Ribosome", "Mitochondria", "Endoplasmic Reticulum"], correct: 2},
{category: "üî¨ Hard Science", q: "What is the most electronegative element on the periodic table?", options: ["Oxygen", "Fluorine", "Chlorine", "Nitrogen"], correct: 1},
{category: "üî¨ Hard Science", q: "At what temperature do Celsius and Fahrenheit scales intersect?", options: ["-40¬∞", "-32¬∞", "0¬∞", "-273¬∞"], correct: 0},
{category: "üî¨ Hard Science", q: "What is it called when a solid turns directly into a gas without becoming liquid?", options: ["Evaporation", "Sublimation", "Condensation", "Fusion"], correct: 1},
{category: "üî¨ Hard Science", q: "Which type of blood vessel has the thickest muscular wall?", options: ["Veins", "Capillaries", "Arteries", "Venules"], correct: 2},
{category: "üî¨ Hard Science", q: "Which fundamental force is responsible for radioactive decay?", options: ["Electromagnetic", "Strong Nuclear", "Weak Nuclear", "Gravitational"], correct: 2},
{category: "üî¨ Hard Science", q: "How many pairs of chromosomes are in a normal human cell?", options: ["21", "22", "23", "24"], correct: 2},
{category: "üî¨ Hard Science", q: "Which phenomenon explains why hot water can freeze faster than cold water?", options: ["Leidenfrost Effect", "Doppler Effect", "Bernoulli Effect", "Mpemba Effect"], correct: 3},
{category: "üî¨ Hard Science", q: "What is the pH of pure water at room temperature?", options: ["6", "7", "8", "9"], correct: 1},
{category: "üî¨ Hard Science", q: "What is the term for the minimum energy required to remove an electron from an atom?", options: ["Electron Affinity", "Ionization Energy", "Electronegativity", "Binding Energy"], correct: 1},
{category: "üî¨ Hard Science", q: "Which law states that the entropy of an isolated system never decreases?", options: ["First Law of Thermodynamics", "Second Law of Thermodynamics", "Zeroth Law of Thermodynamics", "Third Law of Thermodynamics"], correct: 1},
{category: "üî¨ Hard Science", q: "What is the name of the effect where time passes slower in stronger gravitational fields?", options: ["Doppler Effect", "Photoelectric Effect", "Gravitational Time Dilation", "Redshift Effect"], correct: 2},
{category: "üî¨ Hard Science", q: "Which organelle is responsible for protein synthesis in cells?", options: ["Golgi Apparatus", "Ribosomes", "Lysosomes", "Peroxisomes"], correct: 1},
{category: "üî¨ Hard Science", q: "What is the quantum mechanical property that prevents two fermions from occupying the same quantum state?", options: ["Heisenberg Uncertainty", "Pauli Exclusion Principle", "Wave-Particle Duality", "Quantum Entanglement"], correct: 1},

// Hard Questions

{category: "üå°Ô∏è Science", q: "What element is the main constituent of diamonds?", options: ["Carbon", "Oxygen", "Silver", "Gold"], correct: 0},
{category: "üìú History", q: "In what year was Ferdinand Magellan's first successful circumnavigation of the world?", options: ["1492", "1520", "1588", "1620"], correct: 1},
{category: "üåä Geography", q: "Which river is the second longest in the world?", options: ["Amazon", "Yangtze", "Nile", "Mississippi"], correct: 1},
{category: "üöÄ Space", q: "What year was the first man sent to space?", options: ["1957", "1961", "1969", "1975"], correct: 1},
{category: "üåä Geography", q: "Which sea is considered the most salty on Earth?", options: ["Red Sea", "Mediterranean Sea", "Dead Sea", "Black Sea"], correct: 2},
{category: "üî¨ Biology", q: "Which organ in the human body is responsible for the secretion of bile?", options: ["Liver", "Kidneys", "Spleen", "Stomach"], correct: 0},
{category: "üåç Geography", q: "Which planet is known as the 'Morning Star' or 'Evening Star'?", options: ["Venus", "Mars", "Jupiter", "Saturn"], correct: 0},
{category: "üî¨ Science", q: "What is the science that studies the past of life on Earth?", options: ["Palaeontology", "Astronomy", "Anthropology", "Geology"], correct: 0},
{category: "üî¨ Biology", q: "What chemical element forms the basis of haemoglobin?", options: ["Nitrogen", "Iron", "Oxygen", "Silver"], correct: 1},
{category: "üìú History", q: "In what year was the League of Nations founded?", options: ["1919", "1923", "1939", "1945"], correct: 0},
{category: "üåä Geography", q: "Which sea lies between Asia and Africa?", options: ["Caspian", "Red", "Mediterranean", "Dead"], correct: 2},
{category: "üî¨ Biology", q: "Which organ is responsible for secreting insulin?", options: ["Liver", "Kidneys", "Pancreas", "Stomach"], correct: 2},
{category: "üéµ Music", q: "Which composer wrote 'The Four Seasons'?", options: ["Bach", "Mozart", "Vivaldi", "Beethoven"], correct: 2},
{category: "üìö Literature", q: "Who wrote the novel '1984'?", options: ["Aldous Huxley", "George Orwell", "Ray Bradbury", "Isaac Asimov"], correct: 1},
{category: "üìú History", q: "Who was the first woman to win a Nobel Prize?", options: ["Marie Curie", "Mother Teresa", "Jane Addams", "Bertha von Suttner"], correct: 0},
{category: "üî¨ Science", q: "What is considered the 'lung of the Earth'?", options: ["Amazon rainforest", "Sahara Desert", "Siberian Taiga", "Congo Basin"], correct: 0},
{category: "‚öΩ Sports", q: "Which country has won the most FIFA World Cups?", options: ["Germany", "Argentina", "Brazil", "Italy"], correct: 2},
{category: "üî¨ Physics", q: "Which fundamental force is responsible for radioactive decay?", options: ["Electromagnetic", "Strong Nuclear", "Weak Nuclear", "Gravitational"], correct: 2},
            
            // Geography & Landmarks (10 questions)
            {category: "üåç Geography", q: "Which country is shaped like a boot?", options: ["Spain", "Italy", "Greece", "Portugal"], correct: 1},
            {category: "üåç Geography", q: "What is the longest river in the world?", options: ["Amazon", "Nile", "Mississippi", "Yangtze"], correct: 1},
            {category: "üåç Geography", q: "Mount Everest is located between which two countries?", options: ["India & China", "Nepal & China", "Nepal & India", "Bhutan & China"], correct: 1},
            {category: "üåç Geography", q: "Which desert is the largest in the world?", options: ["Sahara", "Gobi", "Antarctica", "Arabian"], correct: 2},
            {category: "üåç Geography", q: "What is the capital of Canada?", options: ["Toronto", "Vancouver", "Montreal", "Ottawa"], correct: 3},
            {category: "üåç Geography", q: "Which ocean is the smallest?", options: ["Arctic", "Indian", "Atlantic", "Pacific"], correct: 0},
            {category: "üåç Geography", q: "The Statue of Liberty was a gift from which country?", options: ["England", "France", "Spain", "Germany"], correct: 1},
            {category: "üåç Geography", q: "Which European city is known as the 'City of Canals'?", options: ["Amsterdam", "Venice", "Bruges", "Stockholm"], correct: 1},
            {category: "üåç Geography", q: "What is the smallest country in the world?", options: ["Monaco", "Vatican City", "San Marino", "Liechtenstein"], correct: 1},
            {category: "üåç Geography", q: "Which mountain range contains Mount Everest?", options: ["Andes", "Alps", "Himalayas", "Rockies"], correct: 2},
            {category: "üåç Geography", q: "Which country has the largest coastline in the world?", options: ["USA", "Russia", "Australia", "Canada"], correct: 0},
            
            // Food & Cuisine (10 questions)
            {category: "üçï Food", q: "What spice is derived from the Crocus flower?", options: ["Turmeric", "Saffron", "Paprika", "Cumin"], correct: 1},
            {category: "üçï Food", q: "Which fruit is known as the 'king of fruits'?", options: ["Mango", "Durian", "Pineapple", "Dragon fruit"], correct: 0},
            {category: "üçï Food", q: "What is the main ingredient in guacamole?", options: ["Tomato", "Avocado", "Pepper", "Onion"], correct: 1},
            {category: "üçï Food", q: "Which country drinks the most coffee per capita?", options: ["Brazil", "Italy", "Finland", "Colombia"], correct: 2},
            {category: "üçï Food", q: "What type of pastry is used to make profiteroles?", options: ["Puff pastry", "Shortcrust pastry", "Choux pastry", "Filo pastry"], correct: 2},
            {category: "üçï Food", q: "Which herb is traditionally used in pesto?", options: ["Oregano", "Basil", "Thyme", "Rosemary"], correct: 1},
            {category: "üçï Food", q: "What is the main ingredient in hummus?", options: ["Lentils", "Chickpeas", "Black beans", "Kidney beans"], correct: 1},
            {category: "üçï Food", q: "Which country originated sushi?", options: ["China", "Japan", "Korea", "Thailand"], correct: 1},
            {category: "üçï Food", q: "What is the hottest part of a chili pepper?", options: ["Skin", "Seeds", "Flesh", "Stem"], correct: 1},
            
            // Technology & Innovation (10 questions)
            {category: "üíª Technology", q: "What does 'GPU' stand for?", options: ["Central Processing Unit", "Graphics Processing Unit", "Graphical Program Unit", "Game Program Unit"], correct: 1},
            {category: "üíª Technology", q: "What does 'Wi-Fi' stand for?", options: ["Wireless Fidelity", "Wireless Frequency", "Wide Fidelity", "It doesn't stand for anything"], correct: 3},
            
            // Animals & Nature (10 questions)
            {category: "ü¶Å Animals", q: "How many hearts does an octopus have?", options: ["1", "2", "3", "4"], correct: 2},
            {category: "ü¶Å Animals", q: "Which bird can fly backwards?", options: ["Eagle", "Sparrow", "Hummingbird", "Robin"], correct: 2},
            {category: "ü¶Å Animals", q: "What is a group of lions called?", options: ["Pack", "Herd", "Pride", "Flock"], correct: 2},
            {category: "ü¶Å Animals", q: "Which mammal is known to have the most powerful bite?", options: ["Lion", "Shark", "Hippo", "Crocodile"], correct: 2},
            {category: "ü¶Å Animals", q: "Which animal can sleep for up to 22 hours a day?", options: ["Sloth", "Koala", "Bear", "Cat"], correct: 1},
            {category: "ü¶Å Animals", q: "What is the largest species of shark?", options: ["Great White", "Tiger Shark", "Whale Shark", "Hammerhead"], correct: 2},
            {category: "ü¶Å Animals", q: "Which animal has the longest lifespan?", options: ["Elephant", "Tortoise", "Whale", "Parrot"], correct: 1},
            {category: "ü¶Å Animals", q: "What is the fastest marine animal?", options: ["Dolphin", "Sailfish", "Tuna", "Marlin"], correct: 1},
            
            // Space & Universe (10 questions)
            {category: "üöÄ Space", q: "Which planet is closest to the Sun?", options: ["Venus", "Mercury", "Earth", "Mars"], correct: 1},
            {category: "üöÄ Space", q: "How many moons does Mars have?", options: ["0", "1", "2", "3"], correct: 2},
            {category: "üöÄ Space", q: "Who was the first person in space?", options: ["Neil Armstrong", "Buzz Aldrin", "Yuri Gagarin", "John Glenn"], correct: 2},
            {category: "üöÄ Space", q: "What is the hottest planet in our solar system?", options: ["Mercury", "Venus", "Mars", "Jupiter"], correct: 1},
            {category: "üöÄ Space", q: "Which space agency landed the first humans on the moon?", options: ["ESA", "NASA", "Roscosmos", "ISRO"], correct: 1},
            
            // Literature & Arts (10 questions)
            {category: "üìö Literature", q: "Who wrote 'Romeo and Juliet'?", options: ["Charles Dickens", "William Shakespeare", "Jane Austen", "Mark Twain"], correct: 1},
            {category: "üìö Literature", q: "Which book begins with 'It was the best of times, it was the worst of times'?", options: ["Great Expectations", "A Tale of Two Cities", "Oliver Twist", "David Copperfield"], correct: 1},
            {category: "üìö Literature", q: "Who painted 'The Starry Night'?", options: ["Pablo Picasso", "Vincent van Gogh", "Leonardo da Vinci", "Claude Monet"], correct: 1},
            {category: "üìö Literature", q: "In which city is Shakespeare's Romeo and Juliet set?", options: ["Venice", "Florence", "Verona", "Rome"], correct: 2},
            {category: "üìö Literature", q: "Who wrote the Harry Potter series?", options: ["J.R.R. Tolkien", "J.K. Rowling", "C.S. Lewis", "Roald Dahl"], correct: 1},
            {category: "üìö Literature", q: "Which artist cut off his own ear?", options: ["Pablo Picasso", "Vincent van Gogh", "Salvador Dal√≠", "Claude Monet"], correct: 1},
            {category: "üìö Literature", q: "What is the first book in the Lord of the Rings series?", options: ["The Two Towers", "The Fellowship of the Ring", "The Return of the King", "The Hobbit"], correct: 1},
            {category: "üìö Literature", q: "Who painted the Mona Lisa?", options: ["Michelangelo", "Leonardo da Vinci", "Raphael", "Donatello"], correct: 1},
            {category: "üìö Literature", q: "Which Shakespeare play features the character Hamlet?", options: ["Macbeth", "Othello", "King Lear", "Hamlet"], correct: 3},
            
            // Random Fun Facts (10 questions)
            {category: "üé≤ Fun Facts", q: "What is the only mammal capable of true flight?", options: ["Flying squirrel", "Bat", "Sugar glider", "Flying lemur"], correct: 1},
            {category: "üé≤ Fun Facts", q: "Which fruit was once considered poisonous by Europeans?", options: ["Potato", "Tomato", "Corn", "Pumpkin"], correct: 1},
            {category: "üé≤ Fun Facts", q: "What color is a giraffe's tongue?", options: ["Pink", "Red", "Blue", "Purple"], correct: 2},
            {category: "üé≤ Fun Facts", q: "How many teeth does an adult human typically have?", options: ["28", "30", "32", "34"], correct: 2},
            {category: "üé≤ Fun Facts", q: "Which planet rains diamonds?", options: ["Jupiter", "Saturn", "Neptune", "Uranus"], correct: 2},
            {category: "üé≤ Fun Facts", q: "What is the fastest land animal?", options: ["Lion", "Horse", "Cheetah", "Gazelle"], correct: 2},
            {category: "üé≤ Fun Facts", q: "How many years can a snail sleep?", options: ["1", "2", "3", "5"], correct: 2},
            {category: "üé≤ Fun Facts", q: "What percentage of the human brain is water?", options: ["60%", "73%", "80%", "85%"], correct: 1},
            {category: "üé≤ Fun Facts", q: "Which animal has three hearts?", options: ["Elephant", "Whale", "Octopus", "Giraffe"], correct: 2},
            {category: "üé≤ Fun Facts", q: "What is the most abundant element in the universe?", options: ["Oxygen", "Carbon", "Hydrogen", "Helium"], correct: 2},
            
            // Music & Entertainment (10 questions)
            {category: "üéµ Music", q: "How many strings does a standard guitar have?", options: ["4", "5", "7", "6"], correct: 3},
            {category: "üéµ Music", q: "Which instrument has 88 keys?", options: ["Organ", "Piano", "Harpsichord", "Accordion"], correct: 1},
            {category: "üéµ Music", q: "What does the musical term 'forte' mean?", options: ["Soft", "Fast", "Loud", "Slow"], correct: 2},
            {category: "üéµ Music", q: "Which band released 'Bohemian Rhapsody'?", options: ["The Beatles", "Led Zeppelin", "Queen", "The Rolling Stones"], correct: 2},
            {category: "üéµ Music", q: "How many beats are in 4/4 time, in music?", options: ["3", "4", "6", "8"], correct: 1},
            {category: "üéµ Music", q: "Which composer wrote 'The Four Seasons'?", options: ["Bach", "Mozart", "Vivaldi", "Beethoven"], correct: 2},
            {category: "üéµ Music", q: "What is the highest singing voice type?", options: ["Alto", "Soprano", "Tenor", "Bass"], correct: 1},
            {category: "üéµ Music", q: "Which instrument is Yo-Yo Ma famous for playing?", options: ["Violin", "Piano", "Cello", "Viola"], correct: 2},
            {category: "üéµ Music", q: "How many lines are on a musical staff?", options: ["4", "5", "6", "7"], correct: 1},
            {category: "üéµ Music", q: "Which country is famous for the tango dance?", options: ["Spain", "Brazil", "Argentina", "Italy"], correct: 2},

             // History & World Events (10 questions)
            {category: "üìú History", q: "Who was the first woman to win a Nobel Prize?", options: ["Marie Curie", "Mother Teresa", "Jane Addams", "Bertha von Suttner"], correct: 0},
            {category: "üìú History", q: "The Titanic sank in which year?", options: ["1910", "1912", "1914", "1916"], correct: 1},
            {category: "üìú History", q: "Which ancient wonder was located in Babylon?", options: ["Colossus of Rhodes", "Hanging Gardens", "Temple of Artemis", "Mausoleum"], correct: 1},
            {category: "üìú History", q: "Who invented the telephone?", options: ["Thomas Edison", "Nikola Tesla", "Alexander Graham Bell", "Benjamin Franklin"], correct: 2},
            {category: "üìú History", q: "The Great Wall of China was built to keep out which group?", options: ["Romans", "Mongols", "Japanese", "Vikings"], correct: 1},
            {category: "üìú History", q: "Which empire was led by Genghis Khan?", options: ["Roman", "Ottoman", "Mongol", "Byzantine"], correct: 2},
            {category: "üìú History", q: "In which year did the Berlin Wall fall?", options: ["1987", "1989", "1991", "1993"], correct: 1},
            {category: "üìú History", q: "Who was the first person to walk on the moon?", options: ["Buzz Aldrin", "Neil Armstrong", "Michael Collins", "Alan Shepard"], correct: 1},
            {category: "üìú History", q: "Which war was fought from 1914 to 1918?", options: ["World War II", "World War I", "Korean War", "Vietnam War"], correct: 1},
            {category: "üìú History", q: "Who painted the ceiling of the Sistine Chapel?", options: ["Leonardo da Vinci", "Raphael", "Michelangelo", "Donatello"], correct: 2},
            
            // Sports & Games (10 questions)
            {category: "‚öΩ Sports", q: "How many minutes are in a rugby match?", options: ["80", "90", "70", "60"], correct: 0},
            {category: "‚öΩ Sports", q: "Which country has won the most FIFA World Cups?", options: ["Germany", "Argentina", "Brazil", "Italy"], correct: 2},
            {category: "‚öΩ Sports", q: "In golf, what is a score of one under par called?", options: ["Eagle", "Birdie", "Bogey", "Albatross"], correct: 1},
            {category: "‚öΩ Sports", q: "How many players are in a volleyball team on court?", options: ["5", "6", "7", "8"], correct: 1},
            {category: "‚öΩ Sports", q: "In which sport would you perform a slam dunk?", options: ["Volleyball", "Basketball", "Tennis", "Badminton"], correct: 1},
            {category: "‚öΩ Sports", q: "How many holes are there in a full round of golf?", options: ["16", "18", "20", "22"], correct: 1},
            {category: "‚öΩ Sports", q: "Which country hosted the 2016 Summer Olympics?", options: ["China", "UK", "Brazil", "Russia"], correct: 2},
            {category: "‚öΩ Sports", q: "What is the maximum score possible in ten-pin bowling?", options: ["200", "250", "300", "350"], correct: 2},
            {category: "‚öΩ Sports", q: "In American football, how many points is a touchdown worth?", options: ["3", "6", "7", "8"], correct: 1},
            
            // Science & Nature (10 questions)
            {category: "üî¨ Science", q: "What is the hardest natural substance on Earth?", options: ["Gold", "Iron", "Diamond", "Platinum"], correct: 2},
            {category: "üî¨ Science", q: "How many bones do sharks have?", options: ["Over 200", "About 100", "Zero", "Around 50"], correct: 2},
            {category: "üî¨ Science", q: "What gas makes up most of Earth's atmosphere?", options: ["Oxygen", "Carbon Dioxide", "Nitrogen", "Hydrogen"], correct: 2},
            {category: "üî¨ Science", q: "How many sides does a snowflake have?", options: ["4", "5", "6", "8"], correct: 2},
            {category: "üî¨ Science", q: "What is the chemical formula for table salt?", options: ["NaCl", "H2O", "CO2", "CaCl2"], correct: 0},
            {category: "üî¨ Science", q: "Which planet has the most moons?", options: ["Jupiter", "Saturn", "Neptune", "Uranus"], correct: 1},
            {category: "üî¨ Science", q: "What type of animal is a Komodo dragon?", options: ["Snake", "Lizard", "Crocodile", "Dinosaur"], correct: 1},
            {category: "üî¨ Science", q: "What is the speed of light in a vacuum?", options: ["299,792,458 m/s", "300,000,000 m/s", "250,000,000 m/s", "350,000,000 m/s"], correct: 0},
            {category: "üî¨ Science", q: "Which blood type is known as the universal donor?", options: ["A+", "B+", "AB+", "O-"], correct: 3},
            {category: "üî¨ Science", q: "What is the smallest unit of matter?", options: ["Molecule", "Atom", "Proton", "Electron"], correct: 1},
            
            // Mathematics & Logic (10 questions)
            {category: "üî¢ Math", q: "What is 70 √ó 80?", options: ["540", "560", "640", "480"], correct: 1},
            {category: "üî¢ Math", q: "What is Pi upto 3 decimal places?", options: ["3.145", "3.154", "3.227", "3.142"], correct: 3},
            {category: "üî¢ Math", q: "How many sides does a hexagon have?", options: ["5", "6", "7", "8"], correct: 1},
            {category: "üî¢ Math", q: "What is the square root of 144?", options: ["11", "14", "13", "12"], correct: 3},
            {category: "üî¢ Math", q: "What is 15% of 200?", options: ["25", "30", "35", "40"], correct: 1},
            {category: "üî¢ Math", q: "What is the sum of angles in a triangle?", options: ["90 degrees", "120 degrees", "270 degrees", "180 degrees"], correct: 3},
            {category: "üî¢ Math", q: "What is 9 squared?", options: ["18", "72", "81", "99"], correct: 2},
            {category: "üî¢ Math", q: "What is the next prime number after 7?", options: ["9", "10", "11", "12"], correct: 2},
            {category: "üî¢ Math", q: "How many seconds are in an hour?", options: ["3000", "3006", "3660", "3600"], correct: 3},
            
            // Languages & Culture (10 questions)
            {category: "üåê Language", q: "What is the most spoken language in the world by native speakers?", options: ["English", "Mandarin Chinese", "Spanish", "Hindi"], correct: 1},
            {category: "üåê Language", q: "What does 'Sayonara' mean in English?", options: ["Hello", "Thank you", "Goodbye", "Please"], correct: 2},
            {category: "üåê Language", q: "Which language uses Cyrillic script?", options: ["Greek", "Russian", "Arabic", "Hindi"], correct: 1},
            {category: "üåê Language", q: "How do you say 'Thank you' in Japanese?", options: ["Konnichiwa", "Sayonara", "Arigatou", "Sumimasen"], correct: 2},
            {category: "üåê Language", q: "Which country has the most official languages?", options: ["India", "South Africa", "Switzerland", "Canada"], correct: 1},
            {category: "üåê Language", q: "What does 'Auf Wiedersehen' mean in English?", options: ["Hello", "Goodbye", "Thank you", "Please"], correct: 1},
            
            // Mythology & Legends (10 questions)
            {category: "‚ö° Mythology", q: "Who is the king of the gods in Greek mythology?", options: ["Poseidon", "Hades", "Apollo", "Zeus"], correct: 3},
            {category: "‚ö° Mythology", q: "What creature is half man, half horse?", options: ["Minotaur", "Centaur", "Griffin", "Phoenix"], correct: 1},
            {category: "‚ö° Mythology", q: "In Norse mythology, what is the name of Thor's hammer?", options: ["Gungnir", "Mjolnir", "Gram", "Laevateinn"], correct: 1},
            {category: "‚ö° Mythology", q: "Who opened the box that released evils into the world?", options: ["Pandora", "Persephone", "Athena", "Aphrodite"], correct: 0},
            {category: "‚ö° Mythology", q: "What type of creature is a Phoenix?", options: ["Dragon", "Bird", "Lion", "Snake"], correct: 1},
            {category: "‚ö° Mythology", q: "In Greek mythology, who is the god of the sea?", options: ["Zeus", "Hades", "Poseidon", "Apollo"], correct: 2},
            {category: "‚ö° Mythology", q: "What is the name of Odin's eight-legged horse in Norse mythology?", options: ["Sleipnir", "Fenrir", "Jormungandr", "Huginn"], correct: 0},
            {category: "‚ö° Mythology", q: "Who is the goddess of wisdom in Greek mythology?", options: ["Athena", "Aphrodite", "Artemis", "Hera"], correct: 0},
            {category: "‚ö° Mythology", q: "What is the name of the tree that connects the nine worlds in Norse mythology?", options: ["Yggdrasil", "Asgard", "Midgard", "Bifrost"], correct: 0},
            {category: "‚ö° Mythology", q: "In Roman mythology, who is the equivalent to the Greek god Zeus?", options: ["Mars", "Jupiter", "Neptune", "Mercury"], correct: 1},
            
            // More Random & Weird Facts (10 questions)
            {category: "ü§Ø Weird Facts", q: "What can't penguins taste?", options: ["Sweet", "Sour", "Bitter", "Salty"], correct: 0},
            {category: "ü§Ø Weird Facts", q: "Which body part continues to grow throughout your life?", options: ["Eyes", "Brain", "Nose and ears", "Heart"], correct: 2},
            {category: "ü§Ø Weird Facts", q: "How many times does a hummingbird's heart beat per minute?", options: ["200", "600", "1000", "1200"], correct: 3},
            {category: "ü§Ø Weird Facts", q: "What is the fear of clowns called?", options: ["Coulrophobia", "Arachnophobia", "Claustrophobia", "Acrophobia"], correct: 0},
            {category: "ü§Ø Weird Facts", q: "Which sense is most closely linked to memory?", options: ["Sight", "Sound", "Smell", "Touch"], correct: 2},
            {category: "ü§Ø Weird Facts", q: "What percentage of your body weight is your brain?", options: ["1%", "3%", "5%", "2%"], correct: 3},
            {category: "ü§Ø Weird Facts", q: "How many times can you fold a piece of paper in half?", options: ["5-6", "7-8", "10-12", "Unlimited"], correct: 1},
            {category: "ü§Ø Weird Facts", q: "What is the loudest animal on Earth?", options: ["Elephant", "Lion", "Blue Whale", "Howler Monkey"], correct: 2},
            {category: "ü§Ø Weird Facts", q: "How many muscles does it take to smile?", options: ["12", "17", "25", "43"], correct: 1},
            {category: "ü§Ø Weird Facts", q: "What is the only food that never expires?", options: ["Salt", "Honey", "Rice", "Pasta"], correct: 1},
            
            // Games & Puzzles (10 questions)
            {category: "üéÆ Games", q: "In chess, which piece can only move diagonally?", options: ["Rook", "Knight", "Bishop", "Queen"], correct: 2},
            {category: "üéÆ Games", q: "How many dots are on a standard die?", options: ["18", "21", "24", "27"], correct: 1},
            {category: "üéÆ Games", q: "In Monopoly, how much money do you collect for passing GO?", options: ["$100", "$150", "$200", "$250"], correct: 2},
            {category: "üéÆ Games", q: "Which video game character is known for eating dots?", options: ["Mario", "Sonic", "Link", "Pac-Man"], correct: 3},
            {category: "üéÆ Games", q: "How many cards are in a standard deck?", options: ["50", "52", "54", "56"], correct: 1},
            {category: "üéÆ Games", q: "In Scrabble, how many points is the letter 'Z' worth?", options: ["8", "10", "12", "15"], correct: 1},
            {category: "üéÆ Games", q: "What is the highest-scoring word in Scrabble using all seven tiles?", options: ["QUIZ", "OXYPHENBUTAZONE", "QUARTZY", "ZYMURGY"], correct: 1},
            {category: "üéÆ Games", q: "In poker, what is the best possible hand?", options: ["Four of a kind", "Full house", "Royal flush", "Straight flush"], correct: 2},
            {category: "üéÆ Games", q: "How many spaces are on a standard Monopoly board?", options: ["36", "40", "44", "48"], correct: 1},
            {category: "üéÆ Games", q: "Which game console was released first?", options: ["PlayStation", "Nintendo 64", "Sega Genesis", "Atari 2600"], correct: 3},

            // Global Geography & Culture (15 questions)
{category: "üåç World Geography", q: "Which city is known as the 'Pearl of the Orient'?", options: ["Bangkok", "Manila", "Shanghai", "Hong Kong"], correct: 3},
{category: "üåç World Geography", q: "Which strait separates Europe and Asia?", options: ["Gibraltar Strait", "Bosporus Strait", "Bering Strait", "Hormuz Strait"], correct: 1},
{category: "üåç World Geography", q: "What is the longest mountain range in the world?", options: ["Andes", "Rockies", "Himalayas", "Mid-Atlantic Ridge"], correct: 0},
{category: "üåç World Geography", q: "Which European country is famous for its fjords?", options: ["Sweden", "Denmark", "Finland", "Norway"], correct: 3},
{category: "üåç World Geography", q: "What is the highest waterfall in the world?", options: ["Niagara Falls", "Angel Falls", "Victoria Falls", "Iguazu Falls"], correct: 1},
{category: "üåç World Geography", q: "Which ocean surrounds the Maldives?", options: ["Pacific Ocean", "Indian Ocean", "Atlantic Ocean", "Arctic Ocean"], correct: 1},
{category: "üåç World Geography", q: "Which country is the largest producer of coffee in the world?", options: ["Vietnam", "Colombia", "Brazil", "Ethiopia"], correct: 2},
{category: "üåç World Geography", q: "What cape sits at the southern tip of Africa?", options: ["Cape Horn", "Cape Verde", "Cape of Good Hope", "Cape Cod"], correct: 2},
{category: "üåç World Geography", q: "Which city is called the 'Gateway to India'?", options: ["Delhi", "Mumbai", "Chennai", "Kolkata"], correct: 1},
{category: "üåç World Geography", q: "What is the largest island in the Mediterranean Sea?", options: ["Sardinia", "Sicily", "Cyprus", "Corsica"], correct: 1},
{category: "üåç World Geography", q: "Which river flows through the Grand Canyon?", options: ["Colorado River", "Mississippi River", "Rio Grande", "Columbia River"], correct: 0},
{category: "üåç World Geography", q: "What do you call a cluster of islands?", options: ["Peninsula", "Archipelago", "Atoll", "Strait"], correct: 1},
{category: "üåç World Geography", q: "Which country has 11 time zones?", options: ["United States", "China", "Russia", "Canada"], correct: 2},
{category: "üåç World Geography", q: "What is the driest continent on Earth?", options: ["Africa", "Australia", "Antarctica", "Asia"], correct: 2},
{category: "üåç World Geography", q: "Which sea is the saltiest in the world?", options: ["Dead Sea", "Red Sea", "Caspian Sea", "Mediterranean Sea"], correct: 0}
        ];
        
        // Add this Fisher-Yates shuffle function
function fisherYatesShuffle(array) {
    const shuffled = [...array];
    for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    return shuffled;
}

        
        function showQuestion() {
    // Clear all previous states from option buttons
    const options = document.querySelectorAll('.option-btn');
    options.forEach(option => {
        option.classList.remove('selected', 'correct', 'incorrect');
        option.disabled = false;
        option.style.transform = 'none'; // Reset any inline transforms
    });
            if (currentQuestion >= selectedQuestions.length) {
                showResults();
                return;
            }
            
            const q = selectedQuestions[currentQuestion];
            document.getElementById('questionNum').textContent = currentQuestion + 1;
            document.getElementById('category').textContent = q.category;
            document.getElementById('question').textContent = q.q;
            document.getElementById('score').textContent = score;
            
            const progress = ((currentQuestion) / selectedQuestions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            
            const optionsDiv = document.getElementById('options');
            optionsDiv.innerHTML = '';
            
            q.options.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
                btn.onclick = () => selectAnswer(index);
                optionsDiv.appendChild(btn);
            });
            
            startTimer();
        }
        
// Fixed timer function - clears previous intervals
function startTimer() {
    // Always clear any existing timer first
    clearInterval(timerInterval);
    
    timer = 30;
    document.getElementById('timer').textContent = timer;
    document.getElementById('timer').classList.remove('warning');
    
    timerInterval = setInterval(() => {
        timer--;
        document.getElementById('timer').textContent = timer;
        
        if (timer <= 10) {
            document.getElementById('timer').classList.add('warning');
        }
        
        if (timer <= 0) {
            clearInterval(timerInterval);
            selectAnswer(-1); // Time up
        }
    }, 1000);
}

// Fixed game start function - clears all intervals
function startGame() {
    // Clear any existing timer intervals
    clearInterval(timerInterval);
    
    selectedQuestions = fisherYatesShuffle(questionBank).slice(0, 25);
    currentQuestion = 0;
    score = 0;
    
    document.getElementById('startScreen').classList.add('hidden');
    document.getElementById('gameScreen').classList.remove('hidden');
    
    startBackgroundMusic();
    showQuestion();
}

// Also update selectAnswer to properly clear interval
function selectAnswer(selectedIndex) {
    clearInterval(timerInterval); // Ensure timer is cleared
    
    const q = selectedQuestions[currentQuestion];
    const options = document.querySelectorAll('.option-btn');
    
    options.forEach(btn => btn.disabled = true);
    
    if (selectedIndex === q.correct) {
        score += 10;
        options[selectedIndex].classList.add('correct');
    } else {
        if (selectedIndex >= 0) {
            options[selectedIndex].classList.add('incorrect');
        }
        options[q.correct].classList.add('correct');
    }
    
    setTimeout(() => {
        currentQuestion++;
        showQuestion();
    }, 1200);
}

        
        function showResults() {
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.remove('hidden');
            stopBackgroundMusic();
            
            const totalQuestions = selectedQuestions.length;
            const percentage = Math.round((score / (totalQuestions * 10)) * 100);
            const resultsDiv = document.getElementById('resultsContent');
            
            let resultHTML = '';
            
            if (percentage >= 80) {
                document.getElementById('resultsScreen').classList.add('victory-animation');
                createConfetti();
                
                resultHTML = `
                    <div class="results-container">
                        <div class="results-icon">üèÜ</div>
                        <h1 style="color: #00d4ff; font-size: 3em; margin-bottom: 15px;">CHAMPION!</h1>
                        <div style="display: flex; align-items: center; justify-content: center; gap: 15px; margin: 30px 0;">
                            <div class="final-score">YOUR SCORE: ${score}/250</div>
                            <button onclick="takeScreenshot()" style="
                                background: linear-gradient(135deg, #2d2d44, #3a3a5c);
                                border: 2px solid #323232;
                                border-radius: 50%;
                                width: 50px;
                                height: 50px;
                                color: white;
                                font-size: 1.5em;
                                cursor: pointer;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                transition: all 0.3s ease;
                            " title="Take Screenshot">üì∏</button>
                        </div>
                        <div class="percentage" style="color: #27ae60;">${percentage}% ACCURACY</div>
                        <div style="background: linear-gradient(135deg, #1a1a3a, #2d2d5a); padding: 20px; border-radius: 15px; margin: 20px 0; box-shadow: 0 10px 20px rgba(26, 26, 58, 0.3);">
                            <h3 style="margin-bottom: 10px; color: #FFD700;">ü•á GOLD MEDAL</h3>
                        </div>
                    </div>
                `;
            } else if (percentage >= 60) {
                resultHTML = `
                    <div class="results-container">
                        <div class="results-icon">üéØ</div>
                        <h1 style="color: #ff6b9d; font-size: 3em; margin-bottom: 15px;">WELL PLAYED!</h1>
                        <div style="display: flex; align-items: center; justify-content: center; gap: 15px; margin: 30px 0;">
                            <div class="final-score">YOUR SCORE: ${score}/250</div>
                            <button onclick="takeScreenshot()" style="
                                background: linear-gradient(135deg, #2d2d44, #3a3a5c);
                                border: 2px solid #323232;
                                border-radius: 50%;
                                width: 50px;
                                height: 50px;
                                color: white;
                                font-size: 1.5em;
                                cursor: pointer;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                transition: all 0.3s ease;
                            " title="Take Screenshot">üì∏</button>
                        </div>
                        <div class="percentage" style="color: #e67e22;">${percentage}% ACCURACY</div>
                        <div style="background: linear-gradient(135deg, #1a1a3a, #2d2d5a); padding: 20px; border-radius: 15px; margin: 20px 0; box-shadow: 0 10px 20px rgba(26, 26, 58, 0.3);">
                            <h3 style="margin-bottom: 10px; color: #C0C0C0;">ü•à SILVER MEDAL</h3>
                        </div>
                    </div>
                `;
            } else {
                resultHTML = `
                    <div class="results-container">
                        <div class="results-icon">üëª</div>
                        <h1 style="color: #e74c3c; font-size: 3em; margin-bottom: 15px;">NICE TRY!</h1>
                        <div style="display: flex; align-items: center; justify-content: center; gap: 15px; margin: 30px 0;">
                            <div class="final-score">YOUR SCORE: ${score}/250</div>
                            <button onclick="takeScreenshot()" style="
                                background: linear-gradient(135deg, #2d2d44, #3a3a5c);
                                border: 2px solid #323232;
                                border-radius: 50%;
                                width: 50px;
                                height: 50px;
                                color: white;
                                font-size: 1.5em;
                                cursor: pointer;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                transition: all 0.3s ease;
                            " title="Take Screenshot">üì∏</button>
                        </div>
                        <div class="percentage" style="color: #e74c3c;">${percentage}% ACCURACY</div>
                        <div style="background: linear-gradient(135deg, #1a1a3a, #2d2d5a); padding: 20px; border-radius: 15px; margin: 20px 0; box-shadow: 0 10px 20px rgba(26, 26, 58, 0.3);">
                            <h3 style="margin-bottom: 10px; color: #CD7F32;">ü•â BRONZE MEDAL</h3>
                        </div>
                    </div>
                `;
            }
            
            resultHTML += `
                <div style="display: flex; gap: 20px; justify-content: center; margin-top: 40px; flex-wrap: wrap;">
                    <button class="btn" onclick="playAgain()" style="background: linear-gradient(135deg, #ff6b9d, #c44569);">
                        üéÆ PLAY
                    </button>
                    <button class="btn" onclick="goHome()" style="background: linear-gradient(135deg, #00d4ff, #0099cc);">
                        üè† HOME
                    </button>
                </div>
            `;
            
            resultsDiv.innerHTML = resultHTML;
        }
        // Function to add share button beside snapshot icon
function addShareButton() {
    // Find all results containers that have the final score display
    const finalScoreContainers = document.querySelectorAll('div[style*="display: flex"][style*="align-items: center"]');
    
    finalScoreContainers.forEach(container => {
        // Check if container has final-score and snapshot button
        if (container.querySelector('.final-score') && container.querySelector('button[title="Take Screenshot"]')) {
            // Avoid duplicate share buttons
            if (container.querySelector('.share-btn')) return;
            
            // Create share button
            const shareBtn = document.createElement('button');
            shareBtn.innerHTML = 'üí¨'; // Share icon
            shareBtn.title = 'Share your score';
            shareBtn.className = 'share-btn';
            shareBtn.style.cssText = `
                background: linear-gradient(135deg, #2d2d44, #3a3a5c);
                border: 2px solid #323232;
                border-radius: 50%;
                width: 50px;
                height: 50px;
                color: white;
                font-size: 1.5em;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: all 0.3s ease;
                margin-left: 6px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            `;
            
            // Hover effects
            shareBtn.addEventListener('mouseenter', () => {
                shareBtn.style.background = 'linear-gradient(135deg, #3a3a5c, #4a4a7c)';
                shareBtn.style.transform = 'scale(1.1)';
                shareBtn.style.boxShadow = '0 8px 20px rgba(0, 212, 255, 0.4)';
            });
            
            shareBtn.addEventListener('mouseleave', () => {
                shareBtn.style.background = 'linear-gradient(135deg, #2d2d44, #3a3a5c)';
                shareBtn.style.transform = 'scale(1)';
                shareBtn.style.boxShadow = '0 5px 15px rgba(0, 0, 0, 0.3)';
            });
            
            // Share functionality
            // Updated share functionality that includes snapshot image
// Robust double-click fallback share functionality
let shareAttempts = 0;
let lastShareTime = 0;

shareBtn.onclick = async () => {
    const currentTime = Date.now();
    const timeSinceLastClick = currentTime - lastShareTime;
    lastShareTime = currentTime;
    
    // Reset attempts after 5 seconds of inactivity
    if (timeSinceLastClick > 5000) {
        shareAttempts = 0;
    }
    
    shareAttempts++;
    
    try {
        if (typeof html2canvas === 'undefined') {
            alert('Please use a modern browser for sharing features');
            return;
        }
        
        // Show different behavior on first vs second attempt
        if (shareAttempts > 1) {
            shareBtn.innerHTML = '‚è≥';
            shareBtn.disabled = true;
        }
        
        const resultsScreen = document.getElementById('resultsScreen');
        const canvas = await html2canvas(resultsScreen);
        
        // Convert to blob with callback (more reliable on mobile)
        canvas.toBlob(async (blob) => {
            if (!blob) {
                if (shareAttempts === 1) {
                    alert('Unable to create image. Please double click share and retry.');
                    return;
                } else {
                    alert('Image creation failed. Try taking a manual screenshot.');
                    shareAttempts = 0;
                    return;
                }
            }
            
            const scoreText = score;
            const percentage = Math.round((parseInt(scoreText) / 250) * 100);
            const shareMessage = `üéØ Hey, I scored ${scoreText}/250 (${percentage}%) in QUIZBOT! ü§ñ\n\nCan you beat my score? Try the Ultimate Quiz Challenge:\n\nhttps://roysiddhest.github.io/quizbot/ `;
            
            try {
                // Create file from blob
                const file = new File([blob], 'quizbot-score.png', { type: 'image/png' });
                
                // Multi-level sharing attempts
                if (navigator.canShare && navigator.canShare({ files: [file] })) {
                    await navigator.share({
                        files: [file],
                        text: shareMessage
                    });
                } else if (navigator.share) {
                    // Text-only sharing
                    await navigator.share({
                        text: shareMessage
                    });
                } else {
                    // Clipboard fallback
                    await navigator.clipboard.writeText(shareMessage);
                    alert('üìã Score details copied to clipboard! Take a screenshot manually to share the image.');
                }
                
                // Reset attempts on successful share
                shareAttempts = 0;
                
            } catch (shareError) {
                console.error('Share API failed:', shareError);
                
                if (shareAttempts === 1) {
                    alert('Share failed. Please click share again to retry.');
                } else {
                    // Final fallback on second attempt
                    try {
                        await navigator.clipboard.writeText(shareMessage);
                        alert('üìã Sharing failed, but your score details are copied to clipboard!');
                    } catch (clipError) {
                        alert('Sharing not supported on this device. Please take a manual screenshot.');
                    }
                    shareAttempts = 0;
                }
            } finally {
                // Re-enable button
                shareBtn.disabled = false;
                shareBtn.innerHTML = 'üí¨';
            }
        });
        
    } catch (error) {
        console.error('General share error:', error);
        
        if (shareAttempts === 1) {
            alert('Share failed. Please click again to retry.');
        } else {
            alert('Unable to share. Please try taking a manual screenshot of your results.');
            shareAttempts = 0;
        }
        
        // Re-enable button
        shareBtn.disabled = false;
        shareBtn.innerHTML = 'üí¨';
    }
};


            // Add share button after snapshot button
            container.appendChild(shareBtn);
        }
    });
}

// Override showResults to add share button
const originalShowResults = window.showResults;
window.showResults = function() {
    originalShowResults.call(this);
    // Add share button after results are displayed
    setTimeout(addShareButton, 100);
};

// Also add to playAgain function
const originalPlayAgain = window.playAgain;
window.playAgain = function() {
    originalPlayAgain.call(this);
};

        
        function createConfetti() {
            const colors = ['#00d4ff', '#ff6b9d', '#c44569', '#27ae60', '#e67e22', '#9b59b6'];
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 3 + 's';
                    confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0%';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => {
                        confetti.remove();
                    }, 3000);
                }, i * 50);
            }
        }
        
        function playAgain() {
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.remove('victory-animation');
            startGame();
        }
        
        function goHome() {
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.remove('victory-animation');
            document.getElementById('startScreen').classList.remove('hidden');
            stopBackgroundMusic();
        }
    </script>
</body>
</html>
